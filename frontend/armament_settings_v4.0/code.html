<!DOCTYPE html>
<html class="dark" lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
        name="viewport" />
    <title>Armament Settings - 1Crypten Space</title>
    <link rel="icon" type="image/png" href="../logo10D.png?v=2">
    <link rel="shortcut icon" type="image/png" href="../logo10D.png?v=2">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Space+Grotesk:wght@500;700&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#D4AF37", // Gold accent
                        secondary: "#007AFF", // Blue accent
                        "background-light": "#F2F2F7",
                        "background-dark": "#050505",
                        surface: "#121212",
                        "accent-blue": "#00D1FF",
                    },
                    fontFamily: {
                        display: ["Space Grotesk", "sans-serif"],
                        sans: ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "12px",
                    },
                },
            },
        };
    </script>
    <style>
        body {
            background-color: #050505;
            -webkit-tap-highlight-color: transparent;
        }

        .neon-border {
            box-shadow: 0 0 15px rgba(0, 209, 255, 0.2);
        }

        .gold-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #D4AF37;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #000;
        }

        .gold-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #D4AF37;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #000;
        }

        .custom-checkbox:checked {
            background-color: #D4AF37;
            border-color: #D4AF37;
        }

        /* [V5.2.5] Discrete Scrollbar */
        .custom-scroll::-webkit-scrollbar {
            width: 3px;
            height: 3px;
        }

        .custom-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
        }

        .custom-scroll:hover::-webkit-scrollbar-thumb {
            background: rgba(212, 175, 55, 0.3);
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }

        /* V4.9.4.2: Elite Vault Evolution */
        html {
            font-size: 14px !important;
        }

        /* Fontes ajustadas para escala Micro */
        .text-\[8px\],
        .text-\[9px\],
        .text-\[10px\] {
            font-size: 10px !important;
        }

        .text-xs {
            font-size: 11px !important;
        }

        /* Fontes sm ‚Üí 13px */
        .text-sm {
            font-size: 12px !important;
            line-height: 1.4 !important;
        }

        /* Fontes base ‚Üí 14px */
        .text-base {
            font-size: 13px !important;
            line-height: 1.4 !important;
        }

        /* Fontes lg ‚Üí 16px */
        .text-lg {
            font-size: 16px !important;
        }

        /* Fontes xl ‚Üí 20px */
        .text-xl {
            font-size: 20px !important;
        }

        /* Fontes 2xl ‚Üí 22px */
        .text-2xl {
            font-size: 22px !important;
        }

        /* Melhorar legibilidade de bot√µes e inputs COMPACTO */
        button,
        .cursor-pointer {
            min-height: 38px !important;
        }

        input {
            font-size: 14px !important;
            padding: 0.75rem 1rem !important;
        }

        /* √çcones Material COMPACTO */
        .material-icons-round {
            font-size: 22px !important;
        }

        /* Layout touch-friendly */
        header {
            min-height: 64px !important;
            padding-top: env(safe-area-inset-top, 20px) !important;
        }

        nav {
            min-height: 64px !important;
            padding-bottom: env(safe-area-inset-bottom, 12px) !important;
        }

        .bg-surface\/50 {
            padding: 12px !important;
        }
    </style>
</head>

<body class="font-sans text-gray-200 antialiased selection:bg-primary selection:text-black custom-scroll">
    <header
        class="sticky top-0 z-50 bg-background-dark/80 backdrop-blur-lg border-b border-white/5 px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div
                class="w-8 h-8 rounded-lg overflow-hidden flex items-center justify-center bg-black border border-white/10">
                <img alt="1Crypten Logo" class="w-6 h-6 object-contain" src="../logo10D.png" />
            </div>
            <h1 class="font-display text-base font-bold tracking-tight text-white uppercase tracking-widest">Armament
            </h1>
        </div>
        <button class="w-10 h-10 rounded-full flex items-center justify-center hover:bg-white/5 transition-colors">
            <span class="material-icons-round text-primary">sensors</span>
        </button>
    </header>
    <main class="max-w-md mx-auto pb-32 pt-4 px-4 space-y-8">
        <section class="space-y-4">
            <div class="flex items-center justify-between px-2">
                <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest">Conex√£o Bybit API</h2>
                <span
                    class="text-[10px] bg-secondary/20 text-secondary px-2 py-0.5 rounded-full border border-secondary/30">ENCRIPTADO</span>
            </div>
            <div class="bg-surface/50 border border-white/5 rounded-2xl p-4 space-y-4">
                <div class="space-y-2">
                    <label class="text-xs font-medium text-gray-400 ml-1">API Key</label>
                    <div class="relative">
                        <input
                            class="w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-primary font-mono focus:ring-0 focus:border-primary/50"
                            readonly="" type="password" value="************************" />
                        <span
                            class="material-icons-round absolute right-3 top-1/2 -translate-y-1/2 text-gray-600 text-sm">visibility_off</span>
                    </div>
                </div>
                <div class="space-y-2">
                    <label class="text-xs font-medium text-gray-400 ml-1">Secret Key</label>
                    <div class="relative">
                        <input
                            class="w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-primary font-mono focus:ring-0 focus:border-primary/50"
                            readonly="" type="password" value="****************************************" />
                        <span
                            class="material-icons-round absolute right-3 top-1/2 -translate-y-1/2 text-gray-600 text-sm">visibility_off</span>
                    </div>
                </div>
                <div class="flex items-center justify-between pt-2">
                    <span class="text-sm font-medium text-white">Ambiente de Execu√ß√£o</span>
                    <div class="flex bg-black p-1 rounded-lg border border-white/10">
                        <button
                            class="px-4 py-1.5 rounded-md text-xs font-bold bg-primary text-black transition-all">MAINNET</button>
                        <button
                            class="px-4 py-1.5 rounded-md text-xs font-bold text-gray-500 hover:text-white transition-all">TESTNET</button>
                    </div>
                </div>
            </div>
        </section>
        <section class="space-y-4">
            <div class="flex items-center gap-2 px-2">
                <span class="material-icons-round text-primary text-lg">shield</span>
                <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest">Gest√£o de Risco</h2>
            </div>
            <div class="bg-surface/50 border border-white/5 rounded-2xl p-5 space-y-8">
                <div class="space-y-4">
                    <div class="flex justify-between items-end">
                        <label class="text-sm font-medium text-white">Limite de Banca (USDT)</label>
                        <span id="bankroll-val" class="text-xl font-display font-bold text-primary">5.000,00</span>
                    </div>
                    <div class="relative flex items-center">
                        <input id="bankroll-slider"
                            class="gold-slider w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer"
                            max="10000" min="100" step="100" type="range" value="5000"
                            oninput="document.getElementById('bankroll-val').textContent = parseFloat(this.value).toLocaleString('pt-BR', {minimumFractionDigits: 2})" />
                    </div>
                    <div class="flex justify-between text-[10px] font-bold text-gray-600">
                        <span>100 USDT</span>
                        <span>10.000 USDT</span>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="flex justify-between items-end">
                        <label class="text-sm font-medium text-white">Alavancagem M√°xima</label>
                        <span id="leverage-val" class="text-xl font-display font-bold text-secondary">50x</span>
                    </div>
                    <div class="relative flex items-center">
                        <input id="leverage-slider"
                            class="w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-secondary"
                            max="100" min="1" step="1" type="range" value="50"
                            oninput="document.getElementById('leverage-val').textContent = this.value + 'x'" />
                    </div>
                    <div class="flex justify-between text-[10px] font-bold text-gray-600">
                        <span>1x</span>
                        <span>100x CROSS</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- üÜï V6.0: Elite Tower Access -->
        <section class="space-y-4">
            <div class="flex items-center gap-2 px-2">
                <span class="material-icons-round text-accent-blue text-lg">radar</span>
                <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest">Observabilidade Elite</h2>
            </div>
            <a href="/tower"
                class="block bg-surface/50 border border-accent-blue/20 rounded-2xl p-4 hover:bg-accent-blue/5 transition-all group overflow-hidden relative">
                <div class="absolute -right-4 -top-4 opacity-5 group-hover:opacity-10 transition-opacity">
                    <span class="material-icons-round text-7xl text-accent-blue">settings_input_antenna</span>
                </div>
                <div class="flex items-center justify-between relative z-10">
                    <div class="flex items-center gap-4">
                        <div
                            class="w-12 h-12 rounded-xl bg-accent-blue/10 flex items-center justify-center border border-accent-blue/20">
                            <span class="material-icons-round text-accent-blue">speed</span>
                        </div>
                        <div>
                            <h3 class="text-sm font-bold text-white uppercase tracking-tighter">Command Tower</h3>
                            <p class="text-[10px] text-gray-500 font-mono">LATENCY & GOVERNANCE ELITE</p>
                        </div>
                    </div>
                    <span
                        class="material-icons-round text-gray-600 group-hover:text-accent-blue transition-colors">arrow_forward</span>
                </div>
            </a>
        </section>
        <section class="space-y-4">
            <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest px-2">Alertas &amp; Notifica√ß√µes</h2>
            <div class="bg-surface/50 border border-white/5 rounded-2xl overflow-hidden divide-y divide-white/5">
                <label class="flex items-center justify-between p-4 cursor-pointer hover:bg-white/5 transition-colors">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center">
                            <span class="material-icons-round text-primary text-sm">notifications_active</span>
                        </div>
                        <span class="text-sm font-medium text-white">Execu√ß√£o de Ordem</span>
                    </div>
                    <input checked=""
                        class="custom-checkbox w-5 h-5 rounded border-gray-700 bg-black text-primary focus:ring-primary focus:ring-offset-black"
                        type="checkbox" />
                </label>
                <label class="flex items-center justify-between p-4 cursor-pointer hover:bg-white/5 transition-colors">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-secondary/10 flex items-center justify-center">
                            <span class="material-icons-round text-secondary text-sm">warning</span>
                        </div>
                        <span class="text-sm font-medium text-white">Liquida√ß√£o Pr√≥xima</span>
                    </div>
                    <input checked=""
                        class="custom-checkbox w-5 h-5 rounded border-gray-700 bg-black text-primary focus:ring-primary focus:ring-offset-black"
                        type="checkbox" />
                </label>
                <label class="flex items-center justify-between p-4 cursor-pointer hover:bg-white/5 transition-colors">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-accent-blue/10 flex items-center justify-center">
                            <span class="material-icons-round text-accent-blue text-sm">auto_graph</span>
                        </div>
                        <span class="text-sm font-medium text-white">Resumo Di√°rio (P&amp;L)</span>
                    </div>
                    <input
                        class="custom-checkbox w-5 h-5 rounded border-gray-700 bg-black text-primary focus:ring-primary focus:ring-offset-black"
                        type="checkbox" />
                </label>
                <!-- V10.5 Captain's Voice Expansion -->
                <label class="flex items-center justify-between p-4 cursor-pointer hover:bg-white/5 transition-colors">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-gold/10 flex items-center justify-center">
                            <span class="material-icons-round text-gold text-sm">record_voice_over</span>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-sm font-medium text-white">Voz do Capit√£o</span>
                            <span class="text-[10px] text-gray-500 tracking-tighter uppercase">Alertas de voz em tempo
                                real</span>
                        </div>
                    </div>
                    <input id="voice-toggle" checked=""
                        class="custom-checkbox w-5 h-5 rounded border-gray-700 bg-black text-primary focus:ring-primary focus:ring-offset-black"
                        type="checkbox" />
                </label>
            </div>
        </section>
        <section class="pt-6 space-y-3">
            <button onclick="saveSettings()"
                class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-display font-bold py-3 rounded-xl shadow-lg shadow-emerald-900/20 active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                <span class="material-icons-round text-sm">save</span>
                SALVAR ALTERA√á√ïES
            </button>
            <button
                class="w-full bg-red-600 hover:bg-red-700 text-white font-display font-bold py-3 rounded-xl shadow-lg shadow-red-900/20 active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                <span class="material-icons-round text-sm">power_settings_new</span>
                ENCERRAR TUDO E DESCONECTAR
            </button>
            <p class="text-center text-[8px] text-red-400/60 mt-3 uppercase tracking-[0.2em]">Protocolo de emerg√™ncia
                n√≠vel Elite</p>
        </section>
    </main>
    <nav
        class="fixed bottom-0 left-0 right-0 bg-background-dark/90 backdrop-blur-xl border-t border-white/10 px-6 py-4 safe-area-bottom">
        <div class="max-w-md mx-auto flex items-center justify-between">
            <button class="flex flex-col items-center gap-1 text-gray-500">
                <span class="material-icons-round text-[28px]">grid_view</span>
                <span class="text-[12px] font-bold">DASHBOARD</span>
            </button>
            <button class="flex flex-col items-center gap-1 text-gray-500">
                <span class="material-icons-round text-[28px]">insights</span>
                <span class="text-[12px] font-bold">MERCADO</span>
            </button>
            <button class="flex flex-col items-center gap-1 text-primary">
                <span class="material-icons-round text-[28px]">architecture</span>
                <span class="text-[12px] font-bold">ARMAMENT</span>
            </button>
            <button class="flex flex-col items-center gap-1 text-gray-500">
                <span class="material-icons-round text-[28px]">account_balance_wallet</span>
                <span class="text-[12px] font-bold">WALLET</span>
            </button>
            <button class="flex flex-col items-center gap-1 text-gray-500">
                <span class="material-icons-round text-[28px]">settings</span>
                <span class="text-[12px] font-bold">PERFIL</span>
            </button>
        </div>
    </nav>

    <script>
        const API_BASE = window.location.origin;

        // Fetch and bind settings
        async function loadSettings() {
            try {
                const res = await fetch(`${API_BASE}/api/system/settings`);
                if (res.ok) {
                    const data = await res.json();
                    if (data.bankroll_limit) {
                        document.getElementById('bankroll-val').textContent = data.bankroll_limit.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
                        document.getElementById('bankroll-slider').value = data.bankroll_limit;
                    }
                    if (data.leverage) {
                        document.getElementById('leverage-val').textContent = data.leverage + "x";
                        document.getElementById('leverage-slider').value = data.leverage;
                    }
                    // Load voice toggle from localStorage (client-side preference)
                    const voiceEnabled = localStorage.getItem('captain_voice_enabled') !== 'false';
                    document.getElementById('voice-toggle').checked = voiceEnabled;
                }
            } catch (e) { console.warn("Failed to load settings"); }
        }

        async function saveSettings() {
            const payload = {
                bankroll_limit: parseFloat(document.getElementById('bankroll-slider').value),
                leverage: parseInt(document.getElementById('leverage-slider').value)
            };
            try {
                // Save voice preference to localStorage
                const voiceEnabled = document.getElementById('voice-toggle').checked;
                localStorage.setItem('captain_voice_enabled', voiceEnabled);

                const res = await fetch(`${API_BASE}/api/system/settings`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (res.ok) alert("Configura√ß√µes salvas com sucesso!");
            } catch (e) { alert("Erro ao salvar configura√ß√µes."); }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', loadSettings);
    </script>
</body>

</html>